---
id: ADR-008
title: "8-State Governance Workflow"
status: accepted
category: architecture
scope: project-wide
created: "2026-02-06"
updated: "2026-02-06"
author: "Katalyst Team"
supersedes: ""
superseded_by: ""
---

# ADR-008: 8-State Governance Workflow

## Status

**Accepted** - 2026-02-06

## Context

The delivery framework needs a formal process for tracking work items (ROAD items) through their lifecycle. Requirements:

1. Architecture decisions must be documented and approved before BDD scenarios are written
2. BDD scenarios must be written and approved before implementation begins
3. Implementation must pass NFR validation (performance, security, accessibility) before completion
4. The workflow must be enforceable by AI agents and CI/CD pipelines
5. Blocked items must be explicitly tracked with a mechanism to re-enter the validation cycle
6. The workflow must be representable as a finite state machine for automated validation

Without formal gates, work items risk being implemented without architectural review, tested without acceptance criteria, or deployed without quality validation.

## Decision

ROAD items progress through an **8-state finite state machine** with explicit quality gates at each transition:

```
proposed → adr_validated → bdd_pending → bdd_complete → implementing → nfr_validating → complete
                                                                     ↘ nfr_blocked ↗
```

**States:**

| State | Description | Gate to Enter |
|-------|-------------|---------------|
| `proposed` | Requirements being defined | Initial state |
| `adr_validated` | Architecture decisions documented and approved | ADRs written and reviewed |
| `bdd_pending` | BDD scenarios being written | ADR gate passed |
| `bdd_complete` | BDD scenarios written and approved | BDD scenarios reviewed |
| `implementing` | Active development underway | BDD gate passed |
| `nfr_validating` | Quality attributes being validated | Implementation complete |
| `nfr_blocked` | NFR validation failed; requires fixes | NFR check failed |
| `complete` | All quality gates passed | All NFRs pass |

**Transition Rules:**
- Forward transitions only (except `nfr_blocked` → `nfr_validating`)
- Each gate requires specific evidence (ADR IDs, BDD feature files, NFR test results)
- The `superpowers-orchestrator` agent enforces transitions
- State is stored in ROAD item frontmatter (`status` field) and `roadmap-data.json`

**Compliance Requirements for Completion:**
- ADR compliance check: pass
- BDD scenarios: all passing
- NFR checks: all applicable NFRs pass
- Agent signatures: minimum 4 agents (architecture, BDD, code, NFR)

## Consequences

### Positive

- Every work item has documented architecture decisions before implementation
- Acceptance criteria (BDD scenarios) exist before code is written
- Quality attributes are validated before work is considered done
- The finite state machine is programmatically enforceable by agents and CI
- Blocked items have a clear re-entry path (`nfr_blocked` → fix → `nfr_validating`)
- Governance compliance is traceable via state history and agent signatures

### Negative

- The 8-state workflow adds overhead for small changes (a typo fix still requires state transitions)
- New team members must learn the governance workflow before contributing
- Agent enforcement requires OpenCode infrastructure to be available
- State transitions require coordination between multiple agents

### Neutral

- The state machine is encoded as a Zod enum in `@foe/schemas` (ROAD-002)
- State transitions are validated by the governance parsers (ROAD-004)
- The Docusaurus roadmap dashboard visualizes current states with Kanban columns

## Alternatives Considered

### Alternative 1: Simple 3-State Workflow (Open / In Progress / Done)

**Description**: Minimal state tracking with no formal quality gates.

**Pros**:
- Simple, easy to understand
- Low overhead
- Works for small projects

**Cons**:
- No enforcement of architecture review before implementation
- No guarantee that BDD scenarios exist
- No NFR validation gate
- Quality issues discovered late in the process

**Why Rejected**: The project requires formal quality gates to ensure architecture, testing, and quality are addressed before code is considered complete.

### Alternative 2: Jira-Style Workflow with Custom Fields

**Description**: Use Jira or GitHub Projects with custom workflow columns and required fields.

**Pros**:
- Visual Kanban boards built-in
- Team collaboration features
- Integration with code hosting

**Cons**:
- External dependency (Jira/GitHub Projects are not code)
- Workflow rules are configured in UI, not version-controlled
- Cannot be enforced by AI agents reading the filesystem
- No integration with Zod schema validation

**Why Rejected**: The governance workflow must be enforced by AI agents operating on the filesystem. External tools cannot be the source of truth when the system is self-governing.

### Alternative 3: Git Branch Protection Rules Only

**Description**: Use git branch protection with required reviews, status checks, and labels.

**Pros**:
- Integrated with existing git workflow
- Enforced at merge time
- No additional tooling

**Cons**:
- Only enforced at PR merge, not during development
- Cannot represent a multi-state lifecycle (only "approved/not approved")
- Labels are informal; no schema validation
- No ADR/BDD/NFR gate concept

**Why Rejected**: Branch protection is a merge-time check, not a lifecycle management tool. The governance workflow tracks work items across their entire lifecycle, not just at the merge point.

## Implementation Notes

- State enum: `z.enum(['proposed', 'adr_validated', 'bdd_pending', 'bdd_complete', 'implementing', 'nfr_validating', 'nfr_blocked', 'complete'])`
- Stored in ROAD item frontmatter: `status: implementing`
- Mirrored in `roadmap-data.json` for Docusaurus plugins
- `superpowers-orchestrator` agent validates transitions before allowing state changes
- `validate:transitions` CLI command (ROAD-004) checks all ROAD items for valid state sequences

## References

- [Governance State Machine Spec](../../agentspec.md)
- [ROAD Item Template](../roads/ROAD-TEMPLATE.md)
- [Superpowers Orchestrator](../../.opencode/agents/superpowers-orchestrator.md)
- [Roadmap Data](../static/roadmap-data.json)

## Compliance

This ADR affects the following areas:
- **Road Items**: ROAD-001, ROAD-002, ROAD-003, ROAD-004, ROAD-005, ROAD-006, ROAD-007, ROAD-008, ROAD-009
- **NFRs**: N/A (process decision, not a quality attribute)
- **BDD Scenarios**: Governance e2e feature files in `stack-tests/features/hybrid/`

---

**Template Version**: 1.0.0
**Last Updated**: 2026-02-06
