---
id: US-047
title: "View FOE Score Trends Over Time"
persona: PER-001
status: draft
capabilities:
  - CAP-014
  - CAP-001
use_cases: []
acceptance_criteria:
  - "Team lead can navigate to /reports/history/:repositoryId"
  - "Line chart displays overall score trend over time"
  - "Three dimension trends (Feedback, Understanding, Confidence) are shown as separate lines"
  - "Chart has hover tooltips showing exact scores and dates"
  - "User can toggle dimension lines on/off"
  - "Date range selector filters data (last 30 days, 90 days, 1 year, all time)"
  - "Chart is responsive and mobile-friendly"
  - "Export button downloads trend data as CSV"
---

# US-047: View FOE Score Trends Over Time

**As an** Engineering Team Lead,
**I want to** view a line chart of FOE scores over time for my repository,
**so that** I can visualize our improvement trajectory and identify periods of stagnation or regression.

## Context

After running multiple FOE scans over weeks or months, the team lead needs to see the big picture. A visual trend line makes it easy to:
- Spot improvement patterns
- Identify when scores plateaued
- Correlate score changes with team initiatives
- Present progress to stakeholders

The backend API already provides trend data via `GET /api/v1/repositories/:id/trend`. This story focuses on building the React UI components to visualize that data.

## Road Items

- **ROAD-042** (FOE Report Trend Visualization) — Implements this story

## Acceptance Criteria

1. **Route Exists**: `/reports/history/:repositoryId` renders the trend page
2. **Multi-Line Chart**: Recharts line chart shows 4 lines (overall + 3 dimensions)
3. **Hover Tooltips**: Hovering over a data point shows:
   - Scan date
   - Overall score
   - Dimension scores
   - Maturity level
4. **Toggle Dimensions**: Checkboxes to show/hide each dimension line
5. **Date Range Filter**: Dropdown with options (30 days, 90 days, 1 year, all time)
6. **Responsive Design**: Works on mobile, tablet, desktop
7. **Loading State**: Shows skeleton loader while fetching data
8. **Error Handling**: Displays friendly message if repository not found or no scans exist
9. **Export Button**: Downloads CSV with columns: date, overall, feedback, understanding, confidence
10. **WCAG 2.1 AA Compliant**: ARIA labels, keyboard navigation, focus indicators

## Technical Details

### API Call
```typescript
const { data } = useQuery(['trend', repositoryId], () => 
  api.get(`/repositories/${repositoryId}/trend`)
);
```

### Component Structure
```tsx
<TrendPage>
  <PageHeader title="Score Trends" />
  <DateRangeSelector onChange={setDateRange} />
  <DimensionToggles onToggle={setVisibleLines} />
  <TrendLineChart data={filteredData} visibleLines={visibleLines} />
  <ExportButton onClick={exportToCSV} />
</TrendPage>
```

### Chart Configuration (Recharts)
```tsx
<LineChart data={data}>
  <CartesianGrid strokeDasharray="3 3" />
  <XAxis dataKey="scanDate" tickFormatter={formatDate} />
  <YAxis domain={[0, 100]} />
  <Tooltip content={<CustomTooltip />} />
  <Legend />
  <Line type="monotone" dataKey="overallScore" stroke="#8884d8" name="Overall" />
  <Line type="monotone" dataKey="feedback" stroke="#82ca9d" name="Feedback" />
  <Line type="monotone" dataKey="understanding" stroke="#ffc658" name="Understanding" />
  <Line type="monotone" dataKey="confidence" stroke="#ff7c7c" name="Confidence" />
</LineChart>
```

## Dependencies

- Existing: `GET /api/v1/repositories/:id/trend` endpoint ✅
- Existing: `ReportRepository.getScoreTrend()` implementation ✅
- New: React components (TrendLineChart, DateRangeSelector)
- New: CSV export utility

## Related Stories

- **US-048** (Track Maturity Level Progression) — Shows maturity timeline
- **US-030** (Compare FOE Reports) — Provides comparison view
- **US-031** (Filter Report Listings) — List view of all reports
