# ── Dev overrides — hot reload with source-mounted volumes ───────────────────
# Usage: docker compose -f docker-compose.yml -f docker-compose.dev.yml up --build
#   or:  bun run dev:docker

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
    ports: !override
      - "3001:3001"     # API (Bun --watch)
      - "3000:3000"     # Web UI (Vite)
    volumes:
      # Mount source code for hot reload
      - ./packages/intelligence/api:/app/packages/intelligence/api
      - ./packages/intelligence/web/src:/app/packages/intelligence/web/src
      - ./packages/foe-schemas/src:/app/packages/foe-schemas/src
      - ./packages/vocabulary/src:/app/packages/vocabulary/src
      - foe-data:/app/data
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      - PORT=3001
      - NODE_ENV=development
      - LOG_LEVEL=debug
    restart: "no"
