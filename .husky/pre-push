#!/bin/sh
# Run comprehensive checks before push

echo "ğŸš€ Running pre-push checks..."

# Check if just is installed
if ! command -v just &> /dev/null; then
    echo "âŒ Error: 'just' command not found. Please install justfile: https://github.com/casey/just"
    exit 1
fi

# Run full check suite
echo "ğŸ” Running full check suite..."
just check || exit 1

# Run BDD smoke tests (API only for speed)
# dev-ready will fail fast with instructions if the dev server is not up.
echo "ğŸ§ª Running BDD smoke tests..."
just bdd-api || {
    echo ""
    echo "âŒ BDD tests failed. Fix issues before pushing."
    echo "   If the dev server was not running, start it with: just dev-docker"
    exit 1
}

echo "âœ… All pre-push checks passed!"
echo "ğŸ’ª Ready to push!"
